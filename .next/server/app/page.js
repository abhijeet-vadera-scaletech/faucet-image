(()=>{var e={};e.id=931,e.ids=[931],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9933:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>h,originalPathname:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>o}),a(5480),a(2029),a(5866);var s=a(3191),r=a(8716),l=a(7922),i=a.n(l),n=a(5231),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);a.d(t,d);let o=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,5480)),"/home/abhijeet/workspace/POC/faucet-image/faucet-finder-web/src/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,2029)),"/home/abhijeet/workspace/POC/faucet-image/faucet-finder-web/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/abhijeet/workspace/POC/faucet-image/faucet-finder-web/src/app/page.tsx"],m="/page",h={require:a,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},7009:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,2994,23)),Promise.resolve().then(a.t.bind(a,6114,23)),Promise.resolve().then(a.t.bind(a,9727,23)),Promise.resolve().then(a.t.bind(a,9671,23)),Promise.resolve().then(a.t.bind(a,1868,23)),Promise.resolve().then(a.t.bind(a,4759,23))},8915:()=>{},463:(e,t,a)=>{Promise.resolve().then(a.bind(a,6015))},6015:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var s=a(326),r=a(7577);let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=(...e)=>e.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim();var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,r.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:a=2,absoluteStrokeWidth:s,className:l="",children:d,iconNode:o,...c},m)=>(0,r.createElement)("svg",{ref:m,...n,width:t,height:t,stroke:e,strokeWidth:s?24*Number(a)/Number(t):a,className:i("lucide",l),...c},[...o.map(([e,t])=>(0,r.createElement)(e,t)),...Array.isArray(d)?d:[d]])),o=(e,t)=>{let a=(0,r.forwardRef)(({className:a,...s},n)=>(0,r.createElement)(d,{ref:n,iconNode:t,className:i(`lucide-${l(e)}`,a),...s}));return a.displayName=`${e}`,a},c=o("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),m=o("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),h=o("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),x=o("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function u(){var e;let[t,a]=(0,r.useState)([]),[l,i]=(0,r.useState)(""),[n,d]=(0,r.useState)(null),[o,u]=(0,r.useState)(0),[p,g]=(0,r.useState)(!1),[b,f]=(0,r.useState)(!1),[j,v]=(0,r.useState)(!1),y=(0,r.useRef)(null),N=(0,r.useRef)(null),w=()=>{N.current?.scrollIntoView({behavior:"smooth"})},k=(0,r.useCallback)(e=>{e.preventDefault(),v(!0)},[]),P=(0,r.useCallback)(e=>{e.preventDefault(),v(!1)},[]),C=(0,r.useCallback)(e=>{e.preventDefault(),v(!1);let t=e.dataTransfer.files[0];t&&M(t)&&_(t)},[]),M=e=>["image/png","image/jpeg","image/jpg"].includes(e.type)&&e.size<=209715200,_=e=>{g(!0),u(0);let t=setInterval(()=>{u(a=>a>=100?(clearInterval(t),g(!1),d(e),100):a+10)},50)},A=async e=>{if(e.preventDefault(),!l.trim()&&!n)return;let s={role:"user",text:l.trim()||void 0,imageUrl:n?URL.createObjectURL(n):void 0};a(e=>[...e,s]),f(!0);try{let e=new FormData;l.trim()&&e.append("message",l.trim()),n&&e.append("image",n),e.append("history",JSON.stringify(t));let s=await fetch("/api/analyze",{method:"POST",body:e}),r=await s.json();if(!s.ok)throw Error(r.error||"Failed to analyze image");let i={role:"assistant",assistantMessage:r.message,matches:r.matches};a(e=>[...e,i])}catch(t){let e={role:"assistant",text:`Error: ${t instanceof Error?t.message:"Something went wrong"}`};a(t=>[...t,e])}finally{f(!1),i(""),d(null),u(0),y.current&&(y.current.value=""),setTimeout(w,100)}};return s.jsx("main",{className:"min-h-screen bg-[#0f172a] py-8 px-4",children:(0,s.jsxs)("div",{className:"max-w-3xl mx-auto",children:[s.jsx("h1",{className:"text-4xl font-bold text-white mb-2 italic",children:"Faucet Finder Chat"}),s.jsx("p",{className:"text-gray-400 mb-8",children:"Ask the assistant to identify faucets and upload photos when needed."}),t.length>0&&(0,s.jsxs)("div",{className:"mb-6 space-y-4",children:[t.map((e,t)=>(0,s.jsxs)("div",{className:"space-y-3",children:["user"===e.role&&(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-orange-500 flex items-center justify-center text-white text-sm font-medium",children:"U"}),(0,s.jsxs)("div",{className:"flex-1",children:[e.text&&s.jsx("p",{className:"text-white",children:e.text}),e.imageUrl&&(0,s.jsxs)("div",{className:"mt-2",children:[s.jsx("p",{className:"text-orange-400 text-sm mb-2",children:"(Image only)"}),s.jsx("img",{src:e.imageUrl,alt:"Uploaded faucet",className:"max-w-xs rounded-lg border border-gray-700"}),s.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Uploaded faucet"})]})]})]}),"assistant"===e.role&&(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-green-600 flex items-center justify-center text-white text-sm font-medium",children:"AI"}),(0,s.jsxs)("div",{className:"flex-1",children:[e.text&&s.jsx("p",{className:"text-white",children:e.text}),e.assistantMessage&&s.jsx("p",{className:"text-white mb-4",children:e.assistantMessage}),e.matches&&e.matches.length>0&&s.jsx("div",{className:"space-y-6",children:e.matches.map((e,t)=>(0,s.jsxs)("div",{className:"border-l-2 border-gray-700 pl-4",children:[(0,s.jsxs)("h4",{className:"text-white font-medium",children:["Match ",t+1,": ",e.filename," ","(confidence: ",e.confidence.toFixed(2),")"]}),s.jsx("p",{className:"text-gray-300 mt-1",children:e.reasoning}),(e.title||e.brand||e.color)&&(0,s.jsxs)("p",{className:"text-gray-500 text-sm mt-2",children:["Title: ",e.title||"N/A"," | Brand:"," ",e.brand||"N/A"," | Color:"," ",e.color||"N/A"]}),e.filename&&(0,s.jsxs)("div",{className:"mt-3",children:[s.jsx("img",{src:`/catalog-images/${encodeURIComponent(e.filename)}`,alt:`Catalog image: ${e.filename}`,className:"max-w-xs rounded-lg border border-gray-700 bg-white"}),(0,s.jsxs)("p",{className:"text-gray-500 text-sm mt-1",children:["Catalog image: ",e.filename]})]})]},t))})]})]})]},t)),b&&(0,s.jsxs)("div",{className:"flex items-center gap-3 text-gray-400",children:[s.jsx(c,{className:"w-5 h-5 animate-spin"}),s.jsx("span",{children:"Finding the best match..."})]}),s.jsx("div",{ref:N})]}),(0,s.jsxs)("form",{onSubmit:A,className:"bg-[#1e293b] rounded-lg p-4 border border-gray-700",children:[(0,s.jsxs)("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-gray-300 text-sm mb-2",children:"Message"}),s.jsx("textarea",{value:l,onChange:e=>i(e.target.value),placeholder:"Describe the faucet or ask for help...",className:"w-full bg-[#334155] text-white rounded-lg p-3 min-h-[80px] resize-y border border-gray-600 focus:border-blue-500 focus:outline-none placeholder-gray-500"})]}),(0,s.jsxs)("div",{className:"mb-4",children:[s.jsx("label",{className:"block text-gray-300 text-sm mb-2",children:"Optional: upload a faucet photo"}),s.jsx("div",{onDragOver:k,onDragLeave:P,onDrop:C,className:`bg-[#334155] rounded-lg p-4 border-2 border-dashed transition-colors ${j?"border-blue-500 bg-blue-500/10":"border-gray-600"}`,children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg bg-[#475569] flex items-center justify-center",children:s.jsx(m,{className:"w-5 h-5 text-gray-400"})}),(0,s.jsxs)("div",{children:[s.jsx("p",{className:"text-white text-sm",children:"Drag and drop file here"}),s.jsx("p",{className:"text-gray-500 text-xs",children:"Limit 200MB per file â€¢ PNG, JPG, JPEG"})]})]}),s.jsx("button",{type:"button",onClick:()=>y.current?.click(),className:"px-4 py-2 bg-[#475569] text-white rounded-lg hover:bg-[#64748b] transition-colors text-sm",children:"Browse files"}),s.jsx("input",{ref:y,type:"file",accept:".png,.jpg,.jpeg",onChange:e=>{let t=e.target.files?.[0];t&&M(t)&&_(t)},className:"hidden"})]})})]}),(p||n)&&(0,s.jsxs)("div",{className:"mb-4 flex items-center gap-3 bg-[#334155] rounded-lg p-3",children:[s.jsx("div",{className:"w-8 h-8 rounded bg-[#475569] flex items-center justify-center",children:s.jsx(h,{className:"w-4 h-4 text-gray-400"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-white text-sm truncate",children:n?.name||"Uploading..."}),p?s.jsx("div",{className:"mt-1 h-1 bg-[#475569] rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-blue-500 transition-all duration-100",style:{width:`${o}%`}})}):s.jsx("p",{className:"text-gray-500 text-xs",children:n&&((e=n.size)<1024?e+"B":e<1048576?(e/1024).toFixed(1)+"KB":(e/1048576).toFixed(1)+"MB")})]}),!p&&s.jsx("button",{type:"button",onClick:()=>{d(null),u(0),y.current&&(y.current.value="")},className:"text-gray-400 hover:text-white transition-colors",children:s.jsx(x,{className:"w-5 h-5"})})]}),s.jsx("button",{type:"submit",disabled:b||p||!l.trim()&&!n,className:"px-6 py-2 bg-[#334155] text-white rounded-lg hover:bg-[#475569] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Send"})]})]})})}},2029:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>l,metadata:()=>r});var s=a(9510);a(5023);let r={title:"Faucet Finder Chat",description:"Ask the assistant to identify faucets and upload photos when needed."};function l({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{className:"antialiased",children:e})})}},5480:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(8570).createProxy)(String.raw`/home/abhijeet/workspace/POC/faucet-image/faucet-finder-web/src/app/page.tsx#default`)},5023:()=>{}};var t=require("../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[276,471],()=>a(9933));module.exports=s})();