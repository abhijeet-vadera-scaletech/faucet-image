(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{7791:function(e,t,a){Promise.resolve().then(a.bind(a,1009))},1009:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return u}});var s=a(7437),r=a(2265);let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),i=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:c,className:d="",children:o,iconNode:m,...x}=e;return(0,r.createElement)("svg",{ref:t,...n,width:s,height:s,stroke:a,strokeWidth:c?24*Number(l)/Number(s):l,className:i("lucide",d),...x},[...m.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(o)?o:[o]])}),d=(e,t)=>{let a=(0,r.forwardRef)((a,s)=>{let{className:n,...d}=a;return(0,r.createElement)(c,{ref:s,iconNode:t,className:i("lucide-".concat(l(e)),n),...d})});return a.displayName="".concat(e),a},o=d("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),m=d("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),x=d("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),h=d("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function u(){var e;let[t,a]=(0,r.useState)([]),[l,i]=(0,r.useState)(""),[n,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(0),[g,p]=(0,r.useState)(!1),[f,b]=(0,r.useState)(!1),[j,v]=(0,r.useState)(!1),N=(0,r.useRef)(null),y=(0,r.useRef)(null),w=()=>{var e;null===(e=y.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},k=(0,r.useCallback)(e=>{e.preventDefault(),v(!0)},[]),C=(0,r.useCallback)(e=>{e.preventDefault(),v(!1)},[]),M=(0,r.useCallback)(e=>{e.preventDefault(),v(!1);let t=e.dataTransfer.files[0];t&&S(t)&&U(t)},[]),S=e=>["image/png","image/jpeg","image/jpg"].includes(e.type)&&e.size<=209715200,U=e=>{p(!0),u(0);let t=setInterval(()=>{u(a=>a>=100?(clearInterval(t),p(!1),c(e),100):a+10)},50)},D=async e=>{if(e.preventDefault(),!l.trim()&&!n)return;let s={role:"user",text:l.trim()||void 0,imageUrl:n?URL.createObjectURL(n):void 0};a(e=>[...e,s]),b(!0);try{let e=new FormData;l.trim()&&e.append("message",l.trim()),n&&e.append("image",n),e.append("history",JSON.stringify(t));let s=await fetch("/api/analyze",{method:"POST",body:e}),r=await s.json();if(!s.ok)throw Error(r.error||"Failed to analyze image");let i={role:"assistant",assistantMessage:r.message,matches:r.matches};a(e=>[...e,i])}catch(t){let e={role:"assistant",text:"Error: ".concat(t instanceof Error?t.message:"Something went wrong")};a(t=>[...t,e])}finally{b(!1),i(""),c(null),u(0),N.current&&(N.current.value=""),setTimeout(w,100)}};return(0,s.jsx)("main",{className:"min-h-screen bg-[#0f172a] py-8 px-4",children:(0,s.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-white mb-2 italic",children:"Faucet Finder Chat"}),(0,s.jsx)("p",{className:"text-gray-400 mb-8",children:"Ask the assistant to identify faucets and upload photos when needed."}),t.length>0&&(0,s.jsxs)("div",{className:"mb-6 space-y-4",children:[t.map((e,t)=>(0,s.jsxs)("div",{className:"space-y-3",children:["user"===e.role&&(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-orange-500 flex items-center justify-center text-white text-sm font-medium",children:"U"}),(0,s.jsxs)("div",{className:"flex-1",children:[e.text&&(0,s.jsx)("p",{className:"text-white",children:e.text}),e.imageUrl&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("p",{className:"text-orange-400 text-sm mb-2",children:"(Image only)"}),(0,s.jsx)("img",{src:e.imageUrl,alt:"Uploaded faucet",className:"max-w-xs rounded-lg border border-gray-700"}),(0,s.jsx)("p",{className:"text-gray-500 text-sm mt-1",children:"Uploaded faucet"})]})]})]}),"assistant"===e.role&&(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-green-600 flex items-center justify-center text-white text-sm font-medium",children:"AI"}),(0,s.jsxs)("div",{className:"flex-1",children:[e.text&&(0,s.jsx)("p",{className:"text-white",children:e.text}),e.assistantMessage&&(0,s.jsx)("p",{className:"text-white mb-4",children:e.assistantMessage}),e.matches&&e.matches.length>0&&(0,s.jsx)("div",{className:"space-y-6",children:e.matches.map((e,t)=>(0,s.jsxs)("div",{className:"border-l-2 border-gray-700 pl-4",children:[(0,s.jsxs)("h4",{className:"text-white font-medium",children:["Match ",t+1,": ",e.filename," ","(confidence: ",e.confidence.toFixed(2),")"]}),(0,s.jsx)("p",{className:"text-gray-300 mt-1",children:e.reasoning}),(e.title||e.brand||e.color)&&(0,s.jsxs)("p",{className:"text-gray-500 text-sm mt-2",children:["Title: ",e.title||"N/A"," | Brand:"," ",e.brand||"N/A"," | Color:"," ",e.color||"N/A"]}),e.filename&&(0,s.jsxs)("div",{className:"mt-3",children:[(0,s.jsx)("img",{src:"/catalog-images/".concat(encodeURIComponent(e.filename)),alt:"Catalog image: ".concat(e.filename),className:"max-w-xs rounded-lg border border-gray-700 bg-white"}),(0,s.jsxs)("p",{className:"text-gray-500 text-sm mt-1",children:["Catalog image: ",e.filename]})]})]},t))})]})]})]},t)),f&&(0,s.jsxs)("div",{className:"flex items-center gap-3 text-gray-400",children:[(0,s.jsx)(o,{className:"w-5 h-5 animate-spin"}),(0,s.jsx)("span",{children:"Finding the best match..."})]}),(0,s.jsx)("div",{ref:y})]}),(0,s.jsxs)("form",{onSubmit:D,className:"bg-[#1e293b] rounded-lg p-4 border border-gray-700",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-gray-300 text-sm mb-2",children:"Message"}),(0,s.jsx)("textarea",{value:l,onChange:e=>i(e.target.value),placeholder:"Describe the faucet or ask for help...",className:"w-full bg-[#334155] text-white rounded-lg p-3 min-h-[80px] resize-y border border-gray-600 focus:border-blue-500 focus:outline-none placeholder-gray-500"})]}),(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("label",{className:"block text-gray-300 text-sm mb-2",children:"Optional: upload a faucet photo"}),(0,s.jsx)("div",{onDragOver:k,onDragLeave:C,onDrop:M,className:"bg-[#334155] rounded-lg p-4 border-2 border-dashed transition-colors ".concat(j?"border-blue-500 bg-blue-500/10":"border-gray-600"),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-lg bg-[#475569] flex items-center justify-center",children:(0,s.jsx)(m,{className:"w-5 h-5 text-gray-400"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-white text-sm",children:"Drag and drop file here"}),(0,s.jsx)("p",{className:"text-gray-500 text-xs",children:"Limit 200MB per file â€¢ PNG, JPG, JPEG"})]})]}),(0,s.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=N.current)||void 0===e?void 0:e.click()},className:"px-4 py-2 bg-[#475569] text-white rounded-lg hover:bg-[#64748b] transition-colors text-sm",children:"Browse files"}),(0,s.jsx)("input",{ref:N,type:"file",accept:".png,.jpg,.jpeg",onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];a&&S(a)&&U(a)},className:"hidden"})]})})]}),(g||n)&&(0,s.jsxs)("div",{className:"mb-4 flex items-center gap-3 bg-[#334155] rounded-lg p-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded bg-[#475569] flex items-center justify-center",children:(0,s.jsx)(x,{className:"w-4 h-4 text-gray-400"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("p",{className:"text-white text-sm truncate",children:(null==n?void 0:n.name)||"Uploading..."}),g?(0,s.jsx)("div",{className:"mt-1 h-1 bg-[#475569] rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-blue-500 transition-all duration-100",style:{width:"".concat(d,"%")}})}):(0,s.jsx)("p",{className:"text-gray-500 text-xs",children:n&&((e=n.size)<1024?e+"B":e<1048576?(e/1024).toFixed(1)+"KB":(e/1048576).toFixed(1)+"MB")})]}),!g&&(0,s.jsx)("button",{type:"button",onClick:()=>{c(null),u(0),N.current&&(N.current.value="")},className:"text-gray-400 hover:text-white transition-colors",children:(0,s.jsx)(h,{className:"w-5 h-5"})})]}),(0,s.jsx)("button",{type:"submit",disabled:f||g||!l.trim()&&!n,className:"px-6 py-2 bg-[#334155] text-white rounded-lg hover:bg-[#475569] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Send"})]})]})})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=7791)}),_N_E=e.O()}]);